#!/usr/bin/env python3
import luigi
import tempfile
import sys
import os
from shutil import copyfile
from optparse import OptionParser
import importlib
import json

from romidata import FSDB
from romidata.runner import DBRunner
from romidata.task import DatabaseConfig

def parse_path(path):
    path = path.rstrip('/')
    print("path = %s"%path)
    if not os.path.isdir(path):
        raise IOError("Scan path not found.")

    path = path.split('/')
    db_path = '/'.join(path[:-1])
    scan_id = path[-1]
    return db_path, scan_id


if __name__ == "__main__":
    db = FSDB("/data/twintz/scanner/calib")
    scan_id = "calib_test1"

    DatabaseConfig.db = db
    DatabaseConfig.scan_id = scan_id

    luigi.run()
